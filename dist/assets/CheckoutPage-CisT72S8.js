import{e as x,u as p,r as h,j as e,a as b,z as o,b as f}from"./index-CzVdNPn5.js";import{u as g,a as y}from"./index.esm-G7npbGOv.js";const v=()=>{const{items:r,total:n,clearCart:d,fetchCart:a}=x(),c=p(),i=n(),{handleSubmit:l}=g();h.useEffect(()=>{a()},[a]);const t=y({mutationFn:async()=>{const s=localStorage.getItem("customerId");if(!s)throw new Error("User not logged in");const m=crypto.randomUUID();return(await f.post(`/order/${s}`,{},{headers:{"Idempotency-Key":m}})).data},onSuccess:()=>{o.success("Order placed successfully!"),d(),c("/")},onError:s=>{console.error("Checkout failed",s),o.error("Failed to place order. Please try again.")}}),u=()=>{t.mutate()};return r.length===0?(t.isPending,e.jsx("div",{className:"text-center py-20",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Your cart is empty"})})):e.jsxs("div",{className:"max-w-4xl mx-auto grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-50 p-8 rounded-xl h-fit",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6",children:r.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[s.name," x ",s.quantity]}),e.jsxs("span",{className:"font-medium",children:["$",(s.price*s.quantity).toFixed(2)]})]},s.id))}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",i.toFixed(2)]})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Confirm Order"}),e.jsxs("form",{onSubmit:l(u),className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-blue-50 text-blue-700 rounded-lg text-sm mb-4",children:"Your order will be processed using your saved account details."}),e.jsx("button",{type:"submit",disabled:t.isPending,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-bold text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:t.isPending?e.jsx(b,{className:"animate-spin h-5 w-5"}):"Place Order"})]})]})]})};export{v as default};
